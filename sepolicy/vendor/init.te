# Super modem mounting
allow fsg_file self:filesystem associate;
allow init fsg_file:dir mounton;
allow init fsg_file:filesystem { getattr mount relabelfrom unmount };
allow init firmware_file:filesystem unmount;

# Allow init to access loop devices
allow init loop_device:blk_file { create setattr unlink };
allowxperm init loop_device:blk_file ioctl {
  LOOP_GET_STATUS64
  LOOP_GET_STATUS
  LOOP_SET_STATUS64
  LOOP_SET_STATUS
  BLKFLSBUF
};

# Product persist
allow init mnt_product_file:dir mounton;

recovery_only(`
  allow init self:capability sys_module;
  allow init rootfs:system module_load;
')
#============= init ==============
allow init debugfs_tracing_debug:dir mounton;
allow init vendor_userdir_file:dir write;
allow init debugfs:file setattr;
allow init proc:file write;
allow init sysfs:file write;
allow init kernel:process setsched;
set_prop(init, bluetooth_prop)
set_prop(init, default_prop)
set_prop(init, vendor_persist_rcs_prop)
set_prop(init, vendor_ssr_prop)
allow init vendor_file:file { execute execute_no_trans };
